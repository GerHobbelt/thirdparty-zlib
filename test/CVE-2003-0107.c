// https://www.securityfocus.com/archive/1/312869 --- originally by Richard Kettlewell
#include <stdlib.h>
#include <errno.h>
#include <stdio.h>
#ifdef ZLIB_COMPAT
#  include "zlib.h"
#else
#  include "zlib-ng.h"
#endif



#if defined(BUILD_MONOLITHIC)
#define main(void)      zlib_CVE2003_0107_test_main(void)
#endif

int main(void)
{
    gzFile f;
    int ret;

    if(!(f = zng_gzopen("/dev/null", "w"))) {
        perror("/dev/null");
        return (1);
    }

    ret = zng_gzprintf(f, "%10240s", "");
    printf("gzprintf -> %d\n", ret);
    ret = zng_gzclose(f);
    printf("gzclose -> %d [%d]\n", ret, errno);

    return (0);
}
